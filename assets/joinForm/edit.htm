<div {$e} class="-edit">
  <form {$f} action="">

    <div class="-body">

      <textarea></textarea>

      <label><input type="checkbox"/> {`JoinForm_Required}</label>

    </div>

    <a {$remove} style="float:left"
       class="action-button"
       href="javascript:void(0)">{`JoinForm_Edit_Remove}</span></a>

    <button type="submit"><span>{`JoinForm_Edit_Submit}</span></button>
    <a {$cancel} style="display:inline-block" 
       class="action-button"
       href="javascript:void(0)">{`JoinForm_Edit_Cancel}</span></a>

  </form>
</div>

<script type="endpoint:json,req:bool,text:string">

here.$e.find("textarea").val(text)
here.$e.find("input").attr("checked",req)

replace = (r) -> 
  if r.field 
    here.$e.replaceWith(r.field.html)
    call r.field.code 
  call r.code

here.$cancel.click () ->
  to_endpoint endpoint, false, replace

here.$f.submit () ->
  data = 
    text: here.$e.find("textarea").val()
    req:  here.$e.find(":checked").length > 0 
  return false if text == ""
  to_endpoint endpoint, data, replace
  return false

here.$remove.click () ->
  to_endpoint endpoint, "delete", () ->
  here.$e.remove()

</script>
